<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Injera Be Wat — Prototype</title>

<style>
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    background:#0b0f14;
    color:#eaf0ff;
    padding:20px;
  }

  h1{margin:0 0 6px}
  .sub{color:#b6c2e3;margin-bottom:16px}

  .board{
    display:flex;
    gap:24px;
    flex-wrap:wrap;
  }

  .left{
    flex:1;
    min-width:320px;
  }

  .right{
    width:300px;
  }

  .zoneTitle{
    font-weight:900;
    margin:12px 0 8px;
  }

  .circleBtn{
    width:140px;
    height:190px;
    border-radius:18px;
    background:#1f2937;
    display:grid;
    place-items:center;
    cursor:pointer;
    font-weight:900;
    letter-spacing:1px;
    border:2px solid #334155;
  }

  .circleBtn.disabled{
    opacity:.4;
    cursor:not-allowed;
  }

  .pickedSlot{
    width:100px;
    height:140px;
    border:2px dashed #334155;
    display:grid;
    place-items:center;
    margin-bottom:10px;
  }

  .row{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
  }

  .card{
    width:80px;
    height:110px;
    border-radius:12px;
    background:#f9fafb;
    color:#0b1220;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:900;
    cursor:pointer;
    box-shadow:0 6px 14px rgba(0,0,0,.4);
  }

  .card.selected{
    outline:4px solid #facc15;
    transform:translateY(-2px);
  }

  button{
    margin-top:8px;
    padding:8px 10px;
    font-weight:800;
    cursor:pointer;
  }

  button:disabled{
    opacity:.4;
    cursor:not-allowed;
  }

  .log{
    background:#020617;
    border:1px solid #334155;
    padding:10px;
    height:260px;
    overflow:auto;
    font-size:13px;
  }

  .log div{margin-bottom:6px}
</style>
</head>

<body>

<h1>Injera Be Wat</h1>
<div class="sub">
Pick from the Circle. Add or Match from the Middle. Capture as much as you can before ending your turn.
</div>

<div class="board">
  <div class="left">

    <div class="zoneTitle">Circle</div>
    <div id="circleBtn" class="circleBtn">PICK</div>

    <div class="zoneTitle">Picked</div>
    <div id="pickedSlot" class="pickedSlot">—</div>

    <button id="btnMatch" disabled>MATCH</button>
    <button id="btnAdd" disabled>ADD</button>
    <button id="btnClear" disabled>CLEAR</button>
    <button id="btnEnd">END TURN</button>

    <div class="zoneTitle">Middle</div>
    <div id="middleRow" class="row"></div>
  </div>

  <div class="right">
    <div class="zoneTitle">Log</div>
    <div id="log" class="log"></div>
  </div>
</div>

<script>
const $ = id => document.getElementById(id);

let deck = [];
let middle = [];
let picked = null;
let selected = new Set();
let capturedThisTurn = false;

function log(msg){
  const d = document.createElement("div");
  d.innerHTML = msg;
  $("log").prepend(d);
}

function newDeck(){
  const d=[];
  for(let i=1;i<=10;i++){
    for(let j=0;j<4;j++) d.push(i);
  }
  d.push("JOKER","JOKER");
  return d.sort(()=>Math.random()-.5);
}

function start(){
  deck = newDeck();
  middle = [deck.pop(), deck.pop(), deck.pop()];
  picked = null;
  selected.clear();
  log("New game started.");
  render();
}

function render(){
  $("circleBtn").classList.toggle("disabled", !!picked);
  $("pickedSlot").innerHTML = picked ?? "—";

  const mid = $("middleRow");
  mid.innerHTML="";
  middle.forEach((v,i)=>{
    const c=document.createElement("div");
    c.className="card"+(selected.has(i)?" selected":"");
    c.textContent=v;
    c.onclick=()=>{
      if(!picked) return;
      selected.has(i)?selected.delete(i):selected.add(i);
      updateButtons();
      render();
    };
    mid.appendChild(c);
  });

  updateButtons();
}

function updateButtons(){
  $("btnClear").disabled = selected.size===0;
  $("btnMatch").disabled = !picked || selected.size===0;
  $("btnAdd").disabled = !picked || selected.size<2 || typeof picked!=="number";
}

$("circleBtn").onclick=()=>{
  if(picked || deck.length===0) return;
  picked = deck.pop();
  selected.clear();
  capturedThisTurn=false;

  if(picked==="JOKER"){
    middle=[];
    picked=null;
    log("JOKER! Middle cleared.");
    return;
  }

  log("Picked "+picked);
  render();
};

$("btnClear").onclick=()=>{
  selected.clear();
  render();
};

$("btnMatch").onclick=()=>{
  const sel=[...selected];
  if(sel.every(i=>middle[i]===picked)){
    sel.sort((a,b)=>b-a).forEach(i=>middle.splice(i,1));
    selected.clear();
    capturedThisTurn=true;
    log("MATCH captured.");
    render();
  }else{
    log("MATCH failed.");
  }
};

$("btnAdd").onclick=()=>{
  const sum=[...selected].reduce((a,i)=>a+middle[i],0);
  if(sum===picked){
    [...selected].sort((a,b)=>b-a).forEach(i=>middle.splice(i,1));
    selected.clear();
    capturedThisTurn=true;
    log("ADD captured.");
    render();
  }else{
    log("ADD failed.");
  }
};

$("btnEnd").onclick=()=>{
  if(!picked) return;
  if(!capturedThisTurn){
    middle.push(picked);
    log("No capture. Card goes to middle.");
  }
  picked=null;
  selected.clear();
  render();
};

start();
</script>

</body>
</html>